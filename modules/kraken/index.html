
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tutorials for using Galaxy Australia">
      
      
        <meta name="author" content="Anna Syme, Gareth Price, Torsten Seemann">
      
      
        <link rel="canonical" href="https://galaxy-au-training.github.io/tutorials/modules/kraken/">
      
      
        <link rel="prev" href="../mlst/">
      
      
        <link rel="next" href="../dge/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>Sample identification - Galaxy Australia Training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/sepsis.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sample-identification-with-kraken" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Galaxy Australia Training" class="md-header__button md-logo" aria-label="Galaxy Australia Training" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Galaxy Australia Training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sample identification
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Galaxy-Au-training/tutorials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Galaxy-Australia-training/tutorials
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Galaxy Australia Training" class="md-nav__button md-logo" aria-label="Galaxy Australia Training" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Galaxy Australia Training
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Galaxy-Au-training/tutorials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Galaxy-Australia-training/tutorials
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../galaxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Learn key tasks
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../galaxy-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download and Delete Data in Galaxy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fastqc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quality control
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../spades/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome assembly
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../prokka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome annotation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../snippy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variant calling - bacteria
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../variants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variant calling - human
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../abricate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Antibiotic-resistant genes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mlst/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using MLST
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Sample identification
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Sample identification
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#get-data" class="md-nav__link">
    <span class="md-ellipsis">
      Get data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Get data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-shared-data" class="md-nav__link">
    <span class="md-ellipsis">
      Use shared data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#or-import-from-the-web" class="md-nav__link">
    <span class="md-ellipsis">
      Or, import from the web
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shorten-file-names" class="md-nav__link">
    <span class="md-ellipsis">
      Shorten file names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-kraken" class="md-nav__link">
    <span class="md-ellipsis">
      Run Kraken
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examine-the-output" class="md-nav__link">
    <span class="md-ellipsis">
      Examine the output
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kraken-report" class="md-nav__link">
    <span class="md-ellipsis">
      Kraken report
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next" class="md-nav__link">
    <span class="md-ellipsis">
      Next
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-this-history-in-galaxy" class="md-nav__link">
    <span class="md-ellipsis">
      See this history in Galaxy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What&rsquo;s next?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RNA-seq - bacteria
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rna-humans/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RNA-seq - eukaryotes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../metagenomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metagenomics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Galaxy workflows - introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow - genome assembly
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow-annotation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow - genome annotation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow-variant-calling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow - variant calling, bacteria
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow-rna-seq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow - Bacterial RNA-seq
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow-metagenomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow - Metagenomics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../shortreads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Short read data
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../refseq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reference genomes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../help/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help!
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#get-data" class="md-nav__link">
    <span class="md-ellipsis">
      Get data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Get data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-shared-data" class="md-nav__link">
    <span class="md-ellipsis">
      Use shared data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#or-import-from-the-web" class="md-nav__link">
    <span class="md-ellipsis">
      Or, import from the web
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shorten-file-names" class="md-nav__link">
    <span class="md-ellipsis">
      Shorten file names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-kraken" class="md-nav__link">
    <span class="md-ellipsis">
      Run Kraken
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examine-the-output" class="md-nav__link">
    <span class="md-ellipsis">
      Examine the output
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kraken-report" class="md-nav__link">
    <span class="md-ellipsis">
      Kraken report
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next" class="md-nav__link">
    <span class="md-ellipsis">
      Next
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-this-history-in-galaxy" class="md-nav__link">
    <span class="md-ellipsis">
      See this history in Galaxy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What&rsquo;s next?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="sample-identification-with-kraken">Sample identification with Kraken</h1>
<p>To identify a sample from sequencing reads, we can use the tool &ldquo;Kraken&rdquo;. This tool can also be used to identify members in a mixed set of reads, for metagenomics.</p>
<ul>
<li>
<p>e.g. reads from one sample &rarr; Kraken &rarr; 95% <em>Staphylococcus aureus</em>.</p>
</li>
<li>
<p>e.g. mixed reads &rarr; Kraken &rarr; 50% <em>Staphylococcus aureus</em>, 40%  <em>Campylobacter concisus</em>, 10% unclassified.</p>
</li>
</ul>
<!-- - is this a proportion of reads?
- is proportion of reads a proxy for relative abundance?
(e.g. something might not sequence well - be truly abundant but rare in the sample) -->

<p>In this tutorial we will use Kraken to confirm the identify of reads from a bacterial isolate.</p>
<p><fn><strong>New to Galaxy?</strong> First try the <a href="../galaxy/">introduction</a> and then learn some <a href="../intro/">key tasks</a></fn></p>
<h2 id="get-data">Get data</h2>
<ul>
<li>Log in to your Galaxy instance (for example, Galaxy Australia, <a href="https://usegalaxy.org.au/">usegalaxy.org.au</a>).</li>
</ul>
<h3 id="use-shared-data">Use shared data</h3>
<p>If you are using Galaxy Australia, you can import the data from a shared data library.</p>
<p>In the top menu bar, go to <ss>Shared Data</ss>.</p>
<ul>
<li>Click on <ss>Data Libraries</ss>.</li>
<li>Click on <fn>Galaxy Australia Training Material: Sample Identification</fn>.</li>
<li>Tick the box next to the four files.</li>
<li>Click the <ss>To History</ss> button, select <em>As Datasets</em>.</li>
<li>Name a new history and click <ss>Import</ss>.</li>
<li>In the top menu bar, click <ss>Analyze Data</ss>.</li>
<li>You should now have four files in your current history.</li>
</ul>
<h3 id="or-import-from-the-web">Or, import from the web</h3>
<p><em>Only follow this step if unable to load the data files from shared data, as described above</em>.</p>
<ul>
<li>In a new browser tab, go to this webpage:</li>
</ul>
<p><a href="https://doi.org/10.5281/zenodo.1319181"><img alt="DOI" src="https://zenodo.org/badge/DOI/10.5281/zenodo.1319181.svg" /></a></p>
<ul>
<li>Right click on a  name: select &ldquo;copy link address&rdquo;</li>
<li>In Galaxy, go to <ss>Get Data</ss> and then Upload File</li>
<li>Click <ss>Paste/Fetch data</ss></li>
<li>A box will appear: paste in link address</li>
<li>Click <ss>Start</ss></li>
<li>Click <ss>Close</ss></li>
<li>The file will now appear in the top of your history panel.</li>
<li>Repeat this for all the files on Zenodo.</li>
</ul>
<h3 id="shorten-file-names">Shorten file names</h3>
<ul>
<li>Click on the pencil icon next to the file name.</li>
<li>In the centre Galaxy panel, click in the box under <ss>Name</ss></li>
<li>Shorten the file name.</li>
<li>Then click <ss>Save</ss></li>
</ul>
<p>You should now have four files in your current history:</p>
<p><img alt="galaxy history" src="images/files2.png" /></p>
<!-- used ERR019289_1 and 2 from EBI. see public data tutorial.
rename and change datatypes. -- not working -->

<h2 id="run-kraken">Run Kraken</h2>
<p>We have a sample that should be <em>Staphylococcus aureus</em>. The paired-end FASTQ read files are:</p>
<ul>
<li><fn>staph_R1.fq</fn> and <fn>staph_R2.fq</fn>.</li>
</ul>
<p>(We will look at the other set of files later on in the tutorial).</p>
<ul>
<li>
<p>Go to <ss>Tools</ss> search bar and type in &ldquo;Kraken&rdquo;. Click on the <em>Kraken</em> tool.  </p>
</li>
<li>
<p>Set the following parameters:</p>
<ul>
<li><ss>Single or paired reads</ss>: <em>Paired</em></li>
<li><ss>Forward strand:</ss> <fn>staph_R1.fq</fn></li>
<li><ss>Reverse strand:</ss> <fn>staph_R2.fq</fn></li>
<li><ss>Select a Kraken database:</ss> <em>Minikraken</em></li>
<li>leave other settings as they are</li>
<li>Click <ss>Execute</ss></li>
</ul>
</li>
</ul>
<!-- ### How it works

Generally: compare sequence to database of known sequence identities.

In detail:

- uses k-mers (default k = 31)
- user to specify a library of genomes
- query database for each k-mer in a sequence
- summarize the hits for all the k-mers from a seq to give the ID
- if seq has no kmers in dbase, it is left unclassified.
-->

<h2 id="examine-the-output">Examine the output</h2>
<p>The output is a file called <fn>Kraken on data x and x: Classification</fn>. This will be at the top of your history pane.</p>
<p>Click <ss>Refresh</ss> if the file hasn&rsquo;t yet turned green.</p>
<p><img alt="refresh" src="images/refresh.png" /></p>
<p>When the file is green, click on the eye icon to view.</p>
<ul>
<li>We will turn this output into something easier to read in the next step.</li>
<li>Column 2 is the sequence ID.</li>
<li>Column 3 is the taxon ID (from NCBI).</li>
<li>Column 5 is a summary of all the taxon IDs that each k-mer in the sequence matched to (taxon ID:number of k-mers).  </li>
</ul>
<p><img alt="classification" src="images/classification.png" /></p>
<!-- Output Format

Each sequence classified by Kraken results in a single line of output. Output lines contain five tab-delimited fields; from left to right, they are:

1. "C"/"U": one letter code indicating that the sequence was either classified or unclassified.
2. The sequence ID, obtained from the FASTA/FASTQ header.
3. The taxonomy ID Kraken used to label the sequence; this is 0 if the sequence is unclassified.
4. The length of the sequence in bp.
5. A space-delimited list indicating the LCA mapping of each k-mer in the sequence. For example, "562:13 561:4 A:31 0:1 562:3" would indicate that:
        a) the first 13 k-mers mapped to taxonomy ID #562
        b) the next 4 k-mers mapped to taxonomy ID #561
        c) the next 31 k-mers contained an ambiguous nucleotide
        d) the next k-mer was not in the database
        e) the last 3 k-mers mapped to taxonomy ID #562
-->

<h2 id="kraken-report">Kraken report</h2>
<ul>
<li>
<p>Go to <ss>Tools</ss> search bar and type in &ldquo;Kraken-report&rdquo;. Click on the <em>Kraken-report</em> tool.</p>
</li>
<li>
<p>Set the following parameters:</p>
<ul>
<li><ss>Kraken output</ss>: <fn>Kraken on data x and x: Classification</fn></li>
<li><ss>Select a Kraken database</ss>: <em>Minikraken</em></li>
<li>Click <ss>Execute</ss></li>
</ul>
</li>
</ul>
<p>The output file is called <fn>Kraken-report on data x</fn>.</p>
<ul>
<li>Click on the eye icon to view.</li>
<li>Column 1: percentage of reads in the clade/taxon in Column 6</li>
<li>Column 2: number of reads in the clade.</li>
<li>Column 3: number of reads in the clade but not further classified.</li>
<li>Column 4: code indicating the rank of the classification: (U)nclassified, (D)omain, (K)ingdom, (P)hylum, (C)lass, (O)rder, (F)amily, (G)enus, (S)pecies).</li>
<li>Column 5: NCBI taxonomy ID.</li>
</ul>
<p><img alt="kraken report" src="images/kraken_output2.png" /></p>
<p>Approximately 95% of reads were classified as <em>Staphylococcus aureus</em>, confirming the correct identity of our bacterial sample.</p>
<ul>
<li>Of these reads, roughly half were uniquely present in <em>S. aureus</em> subsp. <em>aureus</em>, and most of those were uniquely present in strain HO 5096 0412.</li>
<li>The sample strain is therefore most related to the HO 5096 0412 strain.</li>
</ul>
<p>The remaining reads within the <em>S. aureus</em> clade were classified into various taxa.</p>
<ul>
<li>Scroll down column 3 to see the number of reads assigned directly to the taxon in column 6.</li>
<li>These are all very low and can be disregarded.</li>
</ul>
<!-- Output

The output of kraken-report is tab-delimited, with one line per taxon. The fields of the output, from left-to-right, are as follows:

1. Percentage of reads covered by the clade rooted at this taxon
2. Number of reads covered by the clade rooted at this taxon
3. Number of reads assigned directly to this taxon
4. A rank code, indicating (U)nclassified, (D)omain, (K)ingdom, (P)hylum, (C)lass, (O)rder, (F)amily, (G)enus, or (S)pecies. All other ranks are simply filled with a dash.
5. NCBI taxonomy ID
6. Indented scientific name -->

<h2 id="next">Next</h2>
<p>Re-run Kraken with another sample. This sample should be <em>Enterococcus faecalis</em>.</p>
<ul>
<li>Use the files <fn>ent_R1.fq</fn> and <fn>ent_R2.fq</fn>.</li>
<li>Run <ss>Kraken</ss> with these files. These are paired-end reads.</li>
<li>With the <fn>Classification</fn> file from Kraken, run <ss>Kraken-report</ss>.</li>
<li>Cick on the eye icon to view the <fn>Kraken-report</fn> file.</li>
</ul>
<p><img alt="output 1" src="images/sample2_1.png" /></p>
<ul>
<li>
<p>63% are classified to the genus <em>Enterococcus</em>, and most of these to <em>E. faecalis</em>.</p>
</li>
<li>
<p>However, if we scroll down the table of results, we see that 31% are classified to the genus <em>Mycobacterium</em>, mostly <em>M. abscessus</em>. These are not in the same phylum as <em>Enterococcus</em>.</p>
</li>
</ul>
<p><img alt="output2" src="images/sample2_2.png" /></p>
<ul>
<li>This sample is probably contaminated.</li>
</ul>
<h2 id="links">Links</h2>
<p><a href="https://genomebiology.biomedcentral.com/articles/10.1186/gb-2014-15-3-r46">Kraken paper</a></p>
<p><a href="http://ccb.jhu.edu/software/kraken/">Kraken software</a></p>
<h2 id="see-this-history-in-galaxy">See this history in Galaxy</h2>
<p>If you want to see this Galaxy history without performing the steps above:</p>
<ul>
<li>Log in to Galaxy Australia: <a href="https://usegalaxy.org.au/">https://usegalaxy.org.au/</a></li>
<li>Go to <ss>Shared Data</ss></li>
<li>Click <ss>Histories</ss></li>
<li>Click <fn>Completed-kraken-analysis</fn></li>
<li>Click <ss>Import</ss> (at the top right corner)</li>
<li>The analysis should now be showing as your current history.</li>
</ul>
<h2 id="whats-next">What&rsquo;s next?</h2>
<p>To use the tutorials on this website:</p>
<ul>
<li>&#8592; see the list in the left hand panel</li>
<li>&#8598; or, click the <strong>menu button</strong> (three horizontal bars) in the top left of the page</li>
</ul>
<p>You can find more tutorials at the Galaxy Training Network:</p>
<ul>
<li><a href="http://galaxyproject.github.io/training-material/">http://galaxyproject.github.io/training-material/</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; The authors; 2018-
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>